---
import Modal from '../ui/Modal.astro';
import Tabs from '../ui/Tabs.astro';
import ProjectCard from '../cards/ProjectCard.astro';
import { getEntry } from 'astro:content';

interface Props {
    title: string;
    lang?: string;
}

const { title, lang = 'es' } = Astro.props;

const projectsEntry = await getEntry('projects', lang);
const projects = projectsEntry?.data;

const tabs = projects ? [
    { id: 'personal', label: projects.tabNames.personal },
    { id: 'work', label: projects.tabNames.work },
    { id: 'student', label: projects.tabNames.student },
] : [];
---

<Modal id="projects" title={title} variant="project">
    {projects ? (
            <Tabs tabs={tabs} name="projects">
                <div slot="personal" class:list={[
                    'grid gap-6',
                    'grid-cols-[repeat(auto-fill,minmax(300px,1fr))]',
                    'max-md:grid-cols-[repeat(auto-fill,minmax(250px,1fr))] max-md:gap-4',
                    'max-sm:grid-cols-1'
                ]}>
                    {projects.personal.map(project => (
                            <ProjectCard
                                name={project.name}
                                description={project.description}
                                tags={project.tags}
                                links={project.links}
                            />
                    ))}
                </div>

                <div slot="work" class:list={[
                    'grid gap-6',
                    'grid-cols-[repeat(auto-fill,minmax(300px,1fr))]',
                    'max-md:grid-cols-[repeat(auto-fill,minmax(250px,1fr))] max-md:gap-4',
                    'max-sm:grid-cols-1'
                ]}>
                    {projects.work.map(project => (
                            <ProjectCard
                                name={project.name}
                                description={project.description}
                                tags={project.tags}
                                links={project.links}
                            />
                    ))}
                </div>

                <div slot="student" class:list={[
                    'grid gap-6',
                    'grid-cols-[repeat(auto-fill,minmax(300px,1fr))]',
                    'max-md:grid-cols-[repeat(auto-fill,minmax(250px,1fr))] max-md:gap-4',
                    'max-sm:grid-cols-1'
                ]}>
                    {projects.student.map(project => (
                            <ProjectCard
                                name={project.name}
                                description={project.description}
                                tags={project.tags}
                                links={project.links}
                            />
                    ))}
                </div>
            </Tabs>
    ) : (
            <p>No projects found.</p>
    )}
</Modal>